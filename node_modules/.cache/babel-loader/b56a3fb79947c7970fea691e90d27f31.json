{"ast":null,"code":"/*! @azure/msal-common v7.5.0 2022-10-03 */\n'use strict';\n\nimport { ClientAuthError } from '../error/ClientAuthError.js';\nimport { StringUtils } from '../utils/StringUtils.js';\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * JWT Token representation class. Parses token string and generates claims object.\r\n */\n\nvar AuthToken =\n/** @class */\nfunction () {\n  function AuthToken(rawToken, crypto) {\n    if (StringUtils.isEmpty(rawToken)) {\n      throw ClientAuthError.createTokenNullOrEmptyError(rawToken);\n    }\n\n    this.rawToken = rawToken;\n    this.claims = AuthToken.extractTokenClaims(rawToken, crypto);\n  }\n  /**\r\n   * Extract token by decoding the rawToken\r\n   *\r\n   * @param encodedToken\r\n   */\n\n\n  AuthToken.extractTokenClaims = function (encodedToken, crypto) {\n    var decodedToken = StringUtils.decodeAuthToken(encodedToken); // token will be decoded to get the username\n\n    try {\n      var base64TokenPayload = decodedToken.JWSPayload; // base64Decode() should throw an error if there is an issue\n\n      var base64Decoded = crypto.base64Decode(base64TokenPayload);\n      return JSON.parse(base64Decoded);\n    } catch (err) {\n      throw ClientAuthError.createTokenParsingError(err);\n    }\n  };\n  /**\r\n   * Determine if the token's max_age has transpired\r\n   */\n\n\n  AuthToken.checkMaxAge = function (authTime, maxAge) {\n    /*\r\n     * per https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest\r\n     * To force an immediate re-authentication: If an app requires that a user re-authenticate prior to access,\r\n     * provide a value of 0 for the max_age parameter and the AS will force a fresh login.\r\n     */\n    var fiveMinuteSkew = 300000; // five minutes in milliseconds\n\n    if (maxAge === 0 || Date.now() - fiveMinuteSkew > authTime + maxAge) {\n      throw ClientAuthError.createMaxAgeTranspiredError();\n    }\n  };\n\n  return AuthToken;\n}();\n\nexport { AuthToken };","map":{"version":3,"mappings":";;;;;AAAA;;;AAGG;;AAQH;;AAEG;;AACH;AAAA;AAAA;EAMI,SAAYA,SAAZ,CAAYC,QAAZ,EAA8BC,MAA9B,EAA6C;IACzC,IAAIC,WAAW,CAACC,OAAZ,CAAoBH,QAApB,CAAJ,EAAmC;MAC/B,MAAMI,eAAe,CAACC,2BAAhB,CAA4CL,QAA5C,CAAN;IACH;;IAED,KAAKA,QAAL,GAAgBA,QAAhB;IACA,KAAKM,MAAL,GAAcP,SAAS,CAACQ,kBAAV,CAA6BP,QAA7B,EAAuCC,MAAvC,CAAd;EACH;EAED;;;;AAIG;;;EACIF,+BAAP,UAA0BS,YAA1B,EAAgDP,MAAhD,EAA+D;IAE3D,IAAMQ,YAAY,GAAqBP,WAAW,CAACQ,eAAZ,CAA4BF,YAA5B,CAAvC,CAF2D;;IAK3D,IAAI;MACA,IAAMG,kBAAkB,GAAGF,YAAY,CAACG,UAAxC,CADA;;MAIA,IAAMC,aAAa,GAAGZ,MAAM,CAACa,YAAP,CAAoBH,kBAApB,CAAtB;MACA,OAAOI,IAAI,CAACC,KAAL,CAAWH,aAAX,CAAP;IACH,CAND,CAME,OAAOI,GAAP,EAAY;MACV,MAAMb,eAAe,CAACc,uBAAhB,CAAwCD,GAAxC,CAAN;IACH;EACJ,CAdM;EAgBP;;AAEG;;;EACIlB,wBAAP,UAAmBoB,QAAnB,EAAqCC,MAArC,EAAmD;IAC/C;;;;AAIG;IACH,IAAMC,cAAc,GAAG,MAAvB,CAN+C,CAMjB;;IAC9B,IAAKD,MAAM,KAAK,CAAZ,IAAoBE,IAAI,CAACC,GAAL,KAAaF,cAAd,GAAiCF,QAAQ,GAAGC,MAAnE,EAA6E;MACzE,MAAMhB,eAAe,CAACoB,2BAAhB,EAAN;IACH;EACJ,CAVM;;EAWX,OAACzB,SAAD;AAAC,CAlDD","names":["AuthToken","rawToken","crypto","StringUtils","isEmpty","ClientAuthError","createTokenNullOrEmptyError","claims","extractTokenClaims","encodedToken","decodedToken","decodeAuthToken","base64TokenPayload","JWSPayload","base64Decoded","base64Decode","JSON","parse","err","createTokenParsingError","authTime","maxAge","fiveMinuteSkew","Date","now","createMaxAgeTranspiredError"],"sources":["../../src/account/AuthToken.ts"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n\nimport { TokenClaims } from \"./TokenClaims\";\nimport { DecodedAuthToken } from \"./DecodedAuthToken\";\nimport { ClientAuthError } from \"../error/ClientAuthError\";\nimport { StringUtils } from \"../utils/StringUtils\";\nimport { ICrypto } from \"../crypto/ICrypto\";\n\n/**\n * JWT Token representation class. Parses token string and generates claims object.\n */\nexport class AuthToken {\n\n    // Raw Token string\n    rawToken: string;\n    // Claims inside token\n    claims: TokenClaims;\n    constructor(rawToken: string, crypto: ICrypto) {\n        if (StringUtils.isEmpty(rawToken)) {\n            throw ClientAuthError.createTokenNullOrEmptyError(rawToken);\n        }\n\n        this.rawToken = rawToken;\n        this.claims = AuthToken.extractTokenClaims(rawToken, crypto);\n    }\n\n    /**\n     * Extract token by decoding the rawToken\n     *\n     * @param encodedToken\n     */\n    static extractTokenClaims(encodedToken: string, crypto: ICrypto): TokenClaims {\n\n        const decodedToken: DecodedAuthToken = StringUtils.decodeAuthToken(encodedToken);\n\n        // token will be decoded to get the username\n        try {\n            const base64TokenPayload = decodedToken.JWSPayload;\n\n            // base64Decode() should throw an error if there is an issue\n            const base64Decoded = crypto.base64Decode(base64TokenPayload);\n            return JSON.parse(base64Decoded) as TokenClaims;\n        } catch (err) {\n            throw ClientAuthError.createTokenParsingError(err);\n        }\n    }\n\n    /**\n     * Determine if the token's max_age has transpired\n     */\n    static checkMaxAge(authTime: number, maxAge: number): void {\n        /*\n         * per https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest\n         * To force an immediate re-authentication: If an app requires that a user re-authenticate prior to access,\n         * provide a value of 0 for the max_age parameter and the AS will force a fresh login.\n         */\n        const fiveMinuteSkew = 300000; // five minutes in milliseconds\n        if ((maxAge === 0) || ((Date.now() - fiveMinuteSkew) > (authTime + maxAge))) {\n            throw ClientAuthError.createMaxAgeTranspiredError();\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}